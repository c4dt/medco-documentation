

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Local Test Deployment &mdash; MedCo Technical Documentation 0.2.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/medco-favicon-32x32.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Network Test Deployment" href="test-network.html" />
    <link rel="prev" title="Deployment" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MedCo Technical Documentation
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">System Administrator Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../specifications/index.html">Specifications</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Deployment</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Local Test Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="test-network.html">Network Test Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev-local-3nodes.html">Local Development Deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../loading_data/index.html">Loading Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network_architecture.html">Network Architecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MedCo Technical Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">System Administrator Guide</a> &raquo;</li>
        
          <li><a href="index.html">Deployment</a> &raquo;</li>
        
      <li>Local Test Deployment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/system_admin/deployment/test-local-3nodes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="local-test-deployment">
<span id="lbl-deployment-test-local-3nodes"></span><h1>Local Test Deployment<a class="headerlink" href="#local-test-deployment" title="Permalink to this headline">¶</a></h1>
<p>Profile <em>test-local-3nodes</em></p>
<p>This test profile deploys 3 MedCo nodes on a single machine for test purposes. It can be used either on your local
machine, or any other machine to which you have access. The version of the docker images used are the latest released
versions. This profile is for example used for the <a class="reference external" href="https://medco-demo.epfl.ch">MedCo public demo</a>.</p>
<div class="section" id="medco-stack-deployment">
<h2>MedCo Stack Deployment<a class="headerlink" href="#medco-stack-deployment" title="Permalink to this headline">¶</a></h2>
<p>First step is to get the MedCo Deployment latest release.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~
$ wget https://github.com/lca1/medco-deployment/archive/v0.2.0.tar.gz
$ tar xvzf v0.2.0.tar.gz
$ mv medco-deployment-0.2.0 medco-deployment
</pre></div>
</div>
<p>Next step is to download the docker images:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/medco-deployment/compose-profiles/test-local-3nodes
$ docker-compose pull
</pre></div>
</div>
<p>The default configuration of the deployment is suitable if the stack is deployed on your local host, and if you do not
need to modify the default passwords. If so, edit the file <code class="docutils literal notranslate"><span class="pre">~/medco-deployment/compose-profiles/test-local-3nodes/.env</span></code>
to reflect your configuration. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">MEDCO_NODE_URL</span><span class="o">=</span>https://medco-demo.epfl.ch
<span class="nv">HTTP_SCHEME</span><span class="o">=</span>https
<span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>postgres1
<span class="nv">PGADMIN_PASSWORD</span><span class="o">=</span>admin
<span class="nv">KEYCLOAK_PASSWORD</span><span class="o">=</span>keycloak
<span class="nv">I2B2_WILDFLY_PASSWORD</span><span class="o">=</span>admin
<span class="nv">I2B2_SERVICE_PASSWORD</span><span class="o">=</span>pFjy3EjDVwLfT2rB9xkK
<span class="nv">I2B2_USER_PASSWORD</span><span class="o">=</span>demouser
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MEDCO_NODE_URL</span></code> should include the protocol and the fully qualified domain name of the host, <code class="docutils literal notranslate"><span class="pre">HTTP_SCHEME</span></code> should
be <code class="docutils literal notranslate"><span class="pre">http</span></code> or <code class="docutils literal notranslate"><span class="pre">https</span></code>. The other fields control the default passwords for the various services running. Note that
setting the passwords that way works only on the first deployment. If the passwords need to be updated later, you should
use the specific component way of modifying password.</p>
<p>Follow <a class="reference internal" href="../configuration/https.html#lbl-configuration-https"><span class="std std-ref">HTTPS Configuration</span></a> to set up the certificates needed for HTTPS.
If you are deploying on another host than the local host without HTTPS take note of the following:
<a class="reference internal" href="../configuration/keycloak.html#lbl-configuration-keycloak-no-https"><span class="std std-ref">Disabling HTTPS requirement for external connections</span></a>.</p>
<p>Final step is to run the nodes, all three will run simultaneously:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ docker-compose up
</pre></div>
</div>
<p>Wait some time for the initialization of the containers to be done (up to the message: <em>“i2b2-medco-srv… - Started x
of y services (z services are lazy, passive or on-demand)”</em>), this can take up to 10 minutes. For the subsequent runs,
the startup will be faster. In order to stop the containers, hit <code class="docutils literal notranslate"><span class="pre">Ctrl+C</span></code> in the active window.</p>
<p>You can use the command <code class="docutils literal notranslate"><span class="pre">docker-compose</span> <span class="pre">up</span> <span class="pre">-d</span></code> instead to run MedCo in the background and thus not keeping the console
captive. In that case use <code class="docutils literal notranslate"><span class="pre">docker-compose</span> <span class="pre">stop</span></code> to stop the containers.</p>
</div>
<div class="section" id="keycloak-configuration">
<h2>Keycloak Configuration<a class="headerlink" href="#keycloak-configuration" title="Permalink to this headline">¶</a></h2>
<p>Follow the instructions from <a class="reference internal" href="../configuration/keycloak.html#lbl-configuration-keycloak"><span class="std std-ref">Keycloak Configuration</span></a> to be able to use Glowing Bear.</p>
</div>
<div class="section" id="test-the-deployment">
<h2>Test the deployment<a class="headerlink" href="#test-the-deployment" title="Permalink to this headline">¶</a></h2>
<p>In order to test that the local test deployment of MedCo is working, access Glowing Bear in your web browser at
<code class="docutils literal notranslate"><span class="pre">http(s)://&lt;domain</span> <span class="pre">name&gt;</span></code> and use the credentials previously configured during the <a class="reference internal" href="../configuration/keycloak.html#lbl-configuration-keycloak"><span class="std std-ref">Keycloak Configuration</span></a>.
If you are new to Glowing Bear you can watch the <a class="reference external" href="https://glowingbear.app">Glowing Bear user interface walkthrough</a> video.</p>
<p>By default MedCo loads a specific test data, refer to <a class="reference internal" href="../../developer/test_data_description.html#lbl-test-data-description"><span class="std std-ref">Description of the default test data</span></a> for expected results to queries.
To load a dataset, follow the guide <a class="reference internal" href="../loading_data/index.html#lbl-loading-data"><span class="std std-ref">Loading Data</span></a>. For reference, the database address (host) to use during
loading is <code class="docutils literal notranslate"><span class="pre">&lt;domain</span> <span class="pre">name&gt;:5432</span></code> and the databases <code class="docutils literal notranslate"><span class="pre">i2b2medcosrv0</span></code>, <code class="docutils literal notranslate"><span class="pre">i2b2medcosrv1</span></code> and <code class="docutils literal notranslate"><span class="pre">i2b2medcosrv2</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="test-network.html" class="btn btn-neutral float-right" title="Network Test Deployment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Deployment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2019, EPFL LCA1

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>